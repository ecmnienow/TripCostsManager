@page "/"

@inject RecordsService RecordsService
@inject NavigationManager NavigationManager

@inject IJSRuntime jsRuntime

<PageTitle>List of trip costs</PageTitle>

<h1>List of trip costs</h1>

<h4 style="text-align: right;">
    <a class="btn btn-default float-left" @onmouseup="(e) => OnHandleAddRecordClick(e)" @onmousedown="(e) => OnHandleAddRecordClick(e)" @onclick="(e) => OnHandleAddRecordClick(e)">Add record</a>
</h4>

<RecordsTable DataSource="@this.RecordsList" OnClickEdit="@(async (e, r) => await EditRecord(e, r))"></RecordsTable>

<EditForm EditContext="RecordModelContext">
    <FluentValidationValidator />
    <ValidationSummary />

    <Modal ExtraClass="red-input-style" @ref="Modal" Title="@(() => { return RecordModel.RecordId > 0 ? "Edit record" : "Add record"; })" Buttons="Buttons.SaveCancel" Save="async () => await SaveRecord()">
        <TCInputText Id="MarketName" Label="Market" @bind-Value="@RecordModel.MarketName" OnValidation="@(() => RecordModel.MarketName)" />
        <TCInputText Id="Title" Label="Titulo" @bind-Value="@RecordModel.Title" OnValidation="@(() => RecordModel.Title)" />
        <TCInputText Id="Description" Label="Descricao" @bind-Value="@RecordModel.Description" OnValidation="@(() => RecordModel.Description)" />
        <TCInputText Id="Price" Label="Preco" @bind-Value="@RecordModel.Price" OnValidation="@(() => RecordModel.Price)" />
        <TCInputText Id="DateTime" Label="Data e hora" @bind-Value="@RecordModel.DateTime" OnValidation="@(() => RecordModel.DateTime)" />
        @* <TCInputText Id="FileName" Label="Imagem" @bind-Value="@RecordModel.Image" OnValidation="@(() => RecordModel.Image)" /> *@

       @*  <div class="form-group form-inline">
            <GVCheckBox Id="Interested" Label="Interessante" @bind-Value="@RecordModel.Interested" ExtraClass="col-6" />
            <GVCheckBox Id="Ignored" Label="Ignorado" @bind-Value="@RecordModel.Ignored" ExtraClass="col-6" />
        </div> *@
    </Modal>
</EditForm>

@* <EditForm EditContext="RecordModelContext">
    <Modal ExtraClass="red-input-style" @ref="ModalBind" Title="@(() => { return "Vincular jogo"; })" Buttons="Buttons.SaveCancel" Save="async () => await SaveBind()">
        <div class="form-group">
            <BlazoredTypeahead SearchMethod="SearchGame" MinimumLength="2" @bind-Value="BindModel.Game" placeholder="Name">
                <SelectedTemplate Context="bindGameContext">
                    @bindGameContext?.Name
                </SelectedTemplate>
                <ResultTemplate Context="bindGameContext">
                    @bindGameContext.Name
                </ResultTemplate>
            </BlazoredTypeahead>
        </div>
    </Modal>
</EditForm> *@

<EditForm EditContext="AlertModalContext">
    <Modal @ref="ModalAlert" ExtraClass="modal-backgroud" Title="@(() => { return AlertModel.Title; })" Buttons="Buttons.OK">
        <TCText Id="Message" Text="@AlertModel.Message" />
    </Modal>
</EditForm>